<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Use a simple meta refresh to update this page. Time is entered in seconds -->
  <meta http-equiv="refresh" content="300" >

  <title>BistrackPi</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <style>
    .bg-primary, .btn-primary, .table-primary {
            background-color: #053c55ff !important;
        }
    .image-container {
        position: relative;
        display: block; /* or inline-block or block, depending on desired layout */
    }

    .image-text {
        position: absolute;
        top: 50%;
        left: 235px;
        transform: translate(-50%, -50%);
        text-align: center;
        width: 100%; /* Ensure text spans the image width */
    }
  </style>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
</head>
<body>
  <div class="container">
    <div id="pageHeader" class="image-container bg-primary text-white p-2">
      <img src="images/bistrackPi.png" alt="BistrackPi Logo" class="img-fluid">
      <div class="image-text">
        <h1>BisTrackPi</h1>
      </div>
    </div>
    <div class="row mt-2">
        <!-- Add additional tables as needed using the format "Tablen" where "n" is a sequential number -->
        <table id="Table1" class="table table-bordered table-striped table-hover caption-top"></table>
    </div>
    <div class="row">
      <table id="Table2" class="table table-bordered table-striped table-hover caption-top"></table>
    </div>
    <div class="row">
      <p id="lastReloaded" class="text-muted"><em></em></p>
    </div>
    <div id="errMsg" class="d-none" role="alert" />

  <script src="scripts/btpi-utils.js"></script>
  <script>
    $(document).ready(function () {
      // Load the list of queries and process each
      const qList = "data/queryList.json";
      $.getJSON(qList, function(data) {
          queriesArray = data; // Assign the JSON data to the variable
          // Loop through all the objects in the queryList and load each in a table
          let i = 1;
          queriesArray.forEach(function(query) {
            let tableID = '#Table' + i;
            if ($(tableID).length) {
              let tableObj = $(tableID);
              loadTable(query.File, tableObj);
              // Set the caption to the query's Title
              addCaption(tableObj, query.Title);
            } else {
              const msg = "Unable to locate table for query " + query.Name + '. Add a new table in the HTML to load the JSON data';
              showErrorDiv($("#errMsg"), msg);
              console.error(msg);
            }
            i++;
          });
        }).fail(function(jqxhr, textStatus, error) {
          const msg = `Request for ${qList} failed: ${textStatus}, ${error}`;
          showErrorDiv($("#errMsg"), msg);
          console.error(msg);
        });

        // Set the last reload text to current date/time
        $("#lastReloaded").text(`Last reload: ${new Date().toLocaleString()}`);

      // Fade out the header after 6 seconds and remove it to provide more space for the table
      $("#pageHeader").fadeOut(6000, function() {
        $(this).remove();
      });
    });
  </script>
</body>
</html>